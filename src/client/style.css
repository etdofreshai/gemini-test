*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  background: #0f0f0f;
  color: #e0e0e0;
  height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* Auth banner */
#auth-banner {
  display: none;
  background: #1a1a2e;
  border-bottom: 1px solid #2a2a4a;
  padding: 12px 20px;
  text-align: center;
  flex-shrink: 0;
}
#auth-banner.visible { display: block; }
#auth-banner button {
  background: #4a6cf7;
  color: #fff;
  border: none;
  padding: 8px 24px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  margin-left: 12px;
}
#auth-banner button:hover { background: #3b5de7; }
#auth-banner button:disabled { opacity: 0.5; cursor: wait; }

/* Image toolbar */
#image-toolbar {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 20px;
  background: #141414;
  border-bottom: 1px solid #222;
  flex-shrink: 0;
}

#select-mode-btn {
  background: none;
  border: 1px solid #444;
  color: #aaa;
  padding: 5px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 13px;
}
#select-mode-btn:hover { border-color: #666; color: #ddd; }

#selection-toolbar {
  display: none;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}
#selection-toolbar.visible { display: flex; }

#selected-count {
  color: #888;
  font-size: 13px;
  min-width: 80px;
}

#selection-toolbar button {
  background: #2a2a2a;
  border: 1px solid #444;
  color: #ddd;
  padding: 5px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 13px;
}
#selection-toolbar button:hover { background: #333; border-color: #666; }
#selection-toolbar button.danger { background: #7f1d1d; border-color: #991b1b; color: #fca5a5; }
#selection-toolbar button.danger:hover { background: #991b1b; }
#selection-toolbar button.danger:disabled { opacity: 0.4; cursor: not-allowed; }
#selection-toolbar button.secondary { color: #888; }

/* Image grid area */
#grid-area {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
  padding-bottom: 100px;
}

#empty-state {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: #555;
  font-size: 18px;
  user-select: none;
}

#image-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: 12px;
}

.tile {
  position: relative;
  border-radius: 10px;
  overflow: hidden;
  background: #1a1a1a;
  cursor: pointer;
  transition: outline 0.1s;
}
.tile img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  transition: transform 0.2s;
}
.tile:hover img { transform: scale(1.03); }
.tile .overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 8px 12px;
  background: linear-gradient(transparent, rgba(0,0,0,0.8));
  font-size: 12px;
  color: #ccc;
  opacity: 0;
  transition: opacity 0.2s;
}
.tile:hover .overlay { opacity: 1; }

/* Selection mode */
body.selection-mode .tile { cursor: pointer; }
body.selection-mode .tile:hover { outline: 2px solid #4a6cf7; }
.tile.selected { outline: 2px solid #4a6cf7; }
.tile.selected img { opacity: 0.8; }

/* Checkbox on tiles */
.tile-checkbox {
  position: absolute;
  top: 8px;
  left: 8px;
  z-index: 3;
  display: none;
  cursor: pointer;
}
.tile-checkbox input {
  width: 18px;
  height: 18px;
  cursor: pointer;
  accent-color: #4a6cf7;
}
body.selection-mode .tile-checkbox { display: block; }

/* Delete button */
.delete-btn {
  position: absolute;
  top: 8px;
  right: 8px;
  background: rgba(0, 0, 0, 0.65);
  color: #fff;
  border: 1px solid rgba(255, 255, 255, 0.15);
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 14px;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s, background 0.15s;
  z-index: 2;
}
.tile:hover .delete-btn { opacity: 1; }
.delete-btn:hover { background: rgba(180, 30, 30, 0.85); border-color: #ef4444; }
body.selection-mode .delete-btn { display: none; }

.upscale-btn {
  position: absolute;
  top: 8px;
  right: 8px;
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
  border: 1px solid rgba(255, 255, 255, 0.2);
  padding: 4px 10px;
  border-radius: 6px;
  font-size: 11px;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s;
  z-index: 2;
}
/* When both delete and upscale exist, offset upscale below delete */
.tile .delete-btn ~ .upscale-btn,
.tile .upscale-btn {
  top: 8px;
  right: 8px;
}
.tile .delete-btn + .upscale-btn { top: 40px; }
.tile:hover .upscale-btn { opacity: 1; }
.upscale-btn:hover { background: rgba(74, 108, 247, 0.8); border-color: #4a6cf7; }
.upscale-btn:disabled { opacity: 0.5; cursor: wait; }
.upscale-btn.done { background: rgba(46, 125, 50, 0.8); border-color: #4caf50; cursor: default; }
.tile:hover .upscale-btn.done { opacity: 1; }

/* Prompt bar */
#prompt-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: #1a1a1a;
  border-top: 1px solid #2a2a2a;
  padding: 10px 20px 14px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  z-index: 10;
}

#options-row {
  display: flex;
  gap: 8px;
}

#options-row select {
  background: #111;
  border: 1px solid #333;
  color: #aaa;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 12px;
  cursor: pointer;
  outline: none;
}
#options-row select:focus { border-color: #4a6cf7; color: #e0e0e0; }
#options-row select option { background: #1a1a1a; }

#input-row {
  display: flex;
  align-items: center;
  gap: 10px;
}

#file-btn {
  background: none;
  border: 1px solid #333;
  color: #aaa;
  width: 40px;
  height: 40px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  position: relative;
}
#file-btn:hover { border-color: #555; color: #ddd; }
#file-btn.has-files { border-color: #4a6cf7; color: #4a6cf7; }
#file-input { display: none; }
#file-count {
  position: absolute;
  top: -6px;
  right: -6px;
  background: #4a6cf7;
  color: #fff;
  font-size: 10px;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  display: none;
  align-items: center;
  justify-content: center;
}
#file-btn.has-files #file-count { display: flex; }

#prompt-input {
  flex: 1;
  background: #111;
  border: 1px solid #333;
  color: #e0e0e0;
  padding: 10px 16px;
  border-radius: 8px;
  font-size: 15px;
  outline: none;
}
#prompt-input:focus { border-color: #4a6cf7; }
#prompt-input::placeholder { color: #555; }

#submit-btn {
  background: #4a6cf7;
  color: #fff;
  border: none;
  width: 40px;
  height: 40px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}
#submit-btn:hover { background: #3b5de7; }
#submit-btn:disabled { opacity: 0.4; cursor: not-allowed; }

/* Spinner */
.spinner {
  width: 20px;
  height: 20px;
  border: 2px solid rgba(255,255,255,0.3);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 0.6s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* Error toast */
#toast {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: #d32f2f;
  color: #fff;
  padding: 10px 24px;
  border-radius: 8px;
  font-size: 14px;
  z-index: 100;
  display: none;
  max-width: 500px;
  text-align: center;
}
#toast.visible { display: block; }
